<%
# Saltstorm - Fun-Money Betting on the Web
# Copyright (C) 2013  Dustin Leavins
#
# Full license can be found in 'LICENSE.txt'
%>
<div ng-controller='FakeBetController'>
  <nav class='navbar navbar-default navbar-static-top' role='navigation'>
    <div class='navbar-header'>
      <button type='button' class='navbar-toggle' data-toggle='collapse' data-target='.navbar-ex1-collapse'>
        <span class='sr-only'>Toggle navigation</span>
        <span class='icon-bar'></span>
        <span class='icon-bar'></span>
        <span class='icon-bar'></span>
      </button>
      <a class='navbar-brand' href='#'><%= titleize() %></a>
      <p class='navbar-text'>Logged-in as {{ account.displayName }}</p>
    </div>
    <div class='collapse navbar-collapse navbar-ex1-collapse'>
      <ul class='nav navbar-nav navbar-right'>
        <li><a href='/logout'>Logout</a></li>
      </ul>
    </div>
  </nav>
  <div class='row main-video' ng-hide='showBettors'>
    <div class='col-md-9'>
      <%= @video_link %>
    </div>
    <div class='col-md-3'>
    </div>
  </div>
  <div class='row admin-message' ng-show='match.message && !showBettors'>
    <p>Message from admin: {{ match.message }}</p>
  </div>
  <div class='row' ng-hide='showBettors'>
    <div class='col-md-4 bet-a'>
      <div class='row'>
        <div class='col-md-6 participant-a'>
          <p>{{ match.participantA.name }}</p>
          <p>{{ match.participantA.amount | currency: "☺" }}</p>
        </div>
        <div class='col-md-6'>
          <p class='pull-right'><button type='button' class='btn btn-lg btn-bet-a' ng-click='submitBet("a")'>Bet</button></p>
        </div>
      </div>
    </div>
    <div class='col-md-4 bet-info'>
      <form name='betForm'>
        <div class='form-group' ng-class='{"has-error": betForm.amount.$invalid}'>
          <p>
          <input type='number'
                 class='form-control'
                 name='amount'
                 min='1'
                 placeholder='Bet amount'
                 required
                 ng-model='betAmount' />
          </p>
        </div>
        <p>Your Current Balance: {{ account.balance | currency: "☺"  }}</p>
      </form>
      <p ng-show='betUpdateFailed'>Could not update bet</p>
      <p ng-show='bettingThisRound'>You are betting this round!</p>
      <p ng-show='winnerName()'>Winner: {{ winnerName() }}</p>
      <p>Odds: {{ match.odds }}</p>
    </div>
    <div class='col-md-4 bet-b'>
      <div class='row'>
        <div class='col-md-6'>
          <p><button type='button' class='btn btn-lg btn-bet-b' ng-click='submitBet("b")'>Bet</button></p>
        </div>
        <div class='col-md-6 participant-b'>
          <p>{{ match.participantB.name }}</p>
          <p>{{ match.participantB.amount | currency: "☺" }}</p>
        </div>
      </div>
    </div>
  </div>
  <div class='row'>
    <div class='col-md-12'>
      <p class='text-center' ng-hide='showBettors'><a ng-click='showBettors = true' class='btn btn-default'>Show Bettors</a></p>
      <p class='text-center' ng-show='showBettors'><a ng-click='showBettors = false' class='btn btn-default'>Show Main</a></p>
      <div class='row' ng-show='showBettors'>
        <div class='col-md-6'>
          <p>{{ match.participantA.name }}</p>
          <ul ng-show='match.bettors.a.length > 0'>
            <li ng-repeat='bettor in match.bettors.a'>{{bettor}}</li>
          </ul>
        </div>

        <div class='col-md-6'>
          <p>{{ match.participantB.name }}</p>
          <ul ng-show='match.bettors.b.length > 0'>
            <li ng-repeat='bettor in match.bettors.b'>{{bettor}}</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
